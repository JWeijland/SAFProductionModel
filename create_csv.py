import pandas as pd
 
def save_states_data(states_data, path):
    rows = [
        {
            "state": state,
            "max_supply (Tonnes/year)": data["max_supply"],
            "feedstock_price(USD/Tonne)": data["feedstock_price"],
            "feedstock_type": data["feedstock_type"],
        }
        for state, data in states_data.items()
    ]
    df = pd.DataFrame(rows)
    df.to_csv(path, index=False)
    print(f"CSV file '{path}' created successfully.")
 
def save_constants(constants, path):
    df = pd.DataFrame(constants)
    df.to_csv(path, index=False)
    print(f"CSV file '{path}' created successfully.")
 
def save_booleans(booleans, path):
    rows = [{"key": k, "value": v} for k, v in booleans.items()]
    df = pd.DataFrame(rows)
    df.to_csv(path, index=False)
    print(f"CSV file '{path}' created successfully.")
 
def save_demand(demand, path):
    rows = [{"year": k, "value": v} for k, v in demand.items()]
    df = pd.DataFrame(rows)
    df.to_csv(path, index=False)
    print(f"CSV file '{path}' created successfully.")
 
if __name__ == "__main__":
    # States data
    states_data_oversupply = {
        "PUNJAB": {
            "max_supply": 4787000,
            "feedstock_price": 360,
            "feedstock_type": "Rice straw",
        },
        "HARYANA": {
            "max_supply": 4000000,
            "feedstock_price": 360,
            "feedstock_type": "Rice straw",
        },
        "UTTAR_PRADESH": {
            "max_supply": 16500000,
            "feedstock_price": 390,
            "feedstock_type": "Sugarcane bagasse, rice straw",
        },
        "BIHAR": {
            "max_supply": 3333333.333,
            "feedstock_price": 390,
            "feedstock_type": "Rice straw, sugarcane bagasse",
        },
        "ANDHRA_PRADESH": {
            "max_supply": 3000000,
            "feedstock_price": 405,
            "feedstock_type": "Rice straw",
        },
        "TAMIL_NADU": {
            "max_supply": 1333333.333,
            "feedstock_price": 435,
            "feedstock_type": "Sugarcane bagasse",
        },
        "MAHARASHTRA": {
            "max_supply": 10333333.333,
            "feedstock_price": 435,
            "feedstock_type": "Sugarcane bagasse",
        },
        "KARNATAKA": {
            "max_supply": 5666666.667,
            "feedstock_price": 405,
            "feedstock_type": "Sugarcane bagasse",
        },
        "WEST_BENGAL": {
            "max_supply": 5497000,
            "feedstock_price": 405,
            "feedstock_type": "Rice straw",
        },
        "CHHATTISGARH": {
            "max_supply": 2666666.667,
            "feedstock_price": 360,
            "feedstock_type": "Rice straw",
        },
        "ODISHA": {
            "max_supply": 3204666.667,
            "feedstock_price": 360,
            "feedstock_type": "Rice straw",
        },
        "MADHYA_PRADESH": {
            "max_supply": 3333333.333,
            "feedstock_price": 390,
            "feedstock_type": "Rice straw",
        },
        "TELANGANA": {
            "max_supply": 5698000,
            "feedstock_price": 390,
            "feedstock_type": "Rice straw",
        },
        "ASSAM": {
            "max_supply": 2000000,
            "feedstock_price": 480,
            "feedstock_type": "Rice straw",
        },
        "JHARKHAND": {
            "max_supply": 1666666.667,
            "feedstock_price": 435,
            "feedstock_type": "Rice straw",
        },
        "RAJASTHAN": {
            "max_supply": 2333333.333,
            "feedstock_price": 435,
            "feedstock_type": "Rice straw",
        },
        "KERALA": {
            "max_supply": 1000000,
            "feedstock_price": 480,
            "feedstock_type": "Rice straw",
        },
        "GUJARAT": {
            "max_supply": 1583333.333,
            "feedstock_price": 405,
            "feedstock_type": "Sugarcane bagasse",
        },
    }
    save_states_data(states_data_oversupply, "input/states_data_oversupply.csv")



    states_data_undersupply = {
        "PUNJAB": {
            "max_supply": 47870,
            "feedstock_price": 360,
            "feedstock_type": "Rice straw",
        },
        "HARYANA": {
            "max_supply": 40000,
            "feedstock_price": 360,
            "feedstock_type": "Rice straw",
        },
        "UTTAR_PRADESH": {
            "max_supply": 165000,
            "feedstock_price": 390,
            "feedstock_type": "Sugarcane bagasse, rice straw",
        },
        "BIHAR": {
            "max_supply": 33333.333,
            "feedstock_price": 390,
            "feedstock_type": "Rice straw, sugarcane bagasse",
        },
        "ANDHRA_PRADESH": {
            "max_supply": 30000,
            "feedstock_price": 405,
            "feedstock_type": "Rice straw",
        },
        "TAMIL_NADU": {
            "max_supply": 13333.333,
            "feedstock_price": 435,
            "feedstock_type": "Sugarcane bagasse",
        },
        "MAHARASHTRA": {
            "max_supply": 103333.333,
            "feedstock_price": 435,
            "feedstock_type": "Sugarcane bagasse",
        },
        "KARNATAKA": {
            "max_supply": 56666.667,
            "feedstock_price": 405,
            "feedstock_type": "Sugarcane bagasse",
        },
        "WEST_BENGAL": {
            "max_supply": 54970,
            "feedstock_price": 405,
            "feedstock_type": "Rice straw",
        },
        "CHHATTISGARH": {
            "max_supply": 26666.667,
            "feedstock_price": 360,
            "feedstock_type": "Rice straw",
        },
        "ODISHA": {
            "max_supply": 32046.667,
            "feedstock_price": 360,
            "feedstock_type": "Rice straw",
        },
        "MADHYA_PRADESH": {
            "max_supply": 33333.333,
            "feedstock_price": 390,
            "feedstock_type": "Rice straw",
        },
        "TELANGANA": {
            "max_supply": 56980,
            "feedstock_price": 390,
            "feedstock_type": "Rice straw",
        },
        "ASSAM": {
            "max_supply": 20000,
            "feedstock_price": 480,
            "feedstock_type": "Rice straw",
        },
        "JHARKHAND": {
            "max_supply": 16666.667,
            "feedstock_price": 435,
            "feedstock_type": "Rice straw",
        },
        "RAJASTHAN": {
            "max_supply": 23333.333,
            "feedstock_price": 435,
            "feedstock_type": "Rice straw",
        },
        "KERALA": {
            "max_supply": 10000,
            "feedstock_price": 480,
            "feedstock_type": "Rice straw",
        },
        "GUJARAT": {
            "max_supply": 15833.333,
            "feedstock_price": 405,
            "feedstock_type": "Sugarcane bagasse",
        },
    }
    save_states_data(states_data_undersupply, "input/states_data_undersupply.csv")
 
    # Constants
    constants = [
        {
            "key": "min_NPV_threshold",
            "value": 0.00,
            "unit": "",
            "remarks": "NPV threshold for investing",
        },
        {
            "key": "opex",
            "value": 285.71,
            "unit": "USD/tonne SAF produced",
            "remarks": "Operational expenditure per tonne of SAF",
        },
        {
            "key": "transport_cost",
            "value": 600.0,
            "unit": "USD/tonne SAF produced",
            "remarks": "Transport cost per tonne of SAF",
        },
        {
            "key": "profit_margin",
            "value": 250.0,
            "unit": "USD/tonne SAF produced",
            "remarks": "Profit margin of the marginal producer, to produce some revenue.",
        },
        {"key": "initial_num_investors", "value": 1.0, "unit": "", "remarks": ""},
        {"key": "initial_num_SAF_sites", "value": 1.0, "unit": "", "remarks": ""},
        {
            "key": "max_capacity",
            "value": 100000.0,
            "unit": "tonnes SAF/year",
            "remarks": "",
        },
        {
            "key": "feedstock_multiplier_min",
            "value": 1,
            "unit": "",
            "remarks": "To introduce stochasticity in feedstock availability",
        },
        {
            "key": "feedstock_multiplier_max",
            "value": 1,
            "unit": "",
            "remarks": "To introduce stochasticity in feedstock availability",
        },
        {
            "key": "saf_plant_construction_time",
            "value": 4,
            "unit": "years",
            "remarks": "",
        },
        {"key": "DR_sample_min", "value": 0.06, "unit": "", "remarks": ""},
        {"key": "DR_sample_max", "value": 0.12, "unit": "", "remarks": ""},
        {
            "key": "Optimism_factor_sample_min",
            "value": 1.0,
            "unit": "",
            "remarks": "",
        },  #! For now no optimism
        {"key": "Optimism_factor_sample_max", "value": 1.0, "unit": "", "remarks": ""},
        {
            "key": "Investment_horizon_length",
            "value": 25,
            "unit": "years",
            "remarks": "Make into a variable/parameter",
        },
        {
            "key": "DR_sensitivity_parameter",
            "value": 0.2,
            "unit": "",
            "remarks": "Investor sensitivity to DR change",
        },
        {
            "key": "ideal_roace",
            "value": 0.075,
            "unit": "",
            "remarks": "Steers DR change",
        },
        {"key": "DR_min", "value": 0.04, "unit": "", "remarks": ""},
        {"key": "DR_max", "value": 0.2, "unit": "", "remarks": ""},
        {"key": "capex_total_cost", "value": 300000000, "unit": "USD", "remarks": ""},
        {"key": "atf_plus_price", "value": 2000, "unit": "USD/tonne", "remarks": ""},
        {
            "key": "capex_annual_decrease",
            "value": 0.01,
            "unit": "",
            "remarks": "Annual decrease in capex due to technological improvement",
        },
        {
            "key": "blending_mandate",
            "value": 0.01,
            "unit": "",
            "remarks": "Blending mandate for SAF",
        },
        {
            "key": "start_year",
            "value": 2024,
            "unit": "",
            "remarks": "Year when the model starts",
        },
        {   "key": "streamday_min",
            "value": 0.95,
            "unit": "",
            "remarks": "Minimum percentage of streamdays",
        },
        {   "key": "streamday_max",
            "value": 0.98,
            "unit": "",
            "remarks": "Maximum percentage of streamdays",
        },
        {
            "key": "DR_target",
            "value": 0.075,
            "unit": "",
            "remarks": "Target discount rate",
        },
        {
            "key": "ROACE_stability_min",
            "value": 0.06,
            "unit": "",
            "remarks": "Minimum ROACE threshold for tending towards average value",
        },
        {
            "key": "ROACE_stability_max",
            "value": 0.09,
            "unit": "",
            "remarks": "Maximum ROACE threshold for tending towards average value",
        }
    ]
    save_constants(constants, "input/config.csv")
 
    # Booleans
    booleans = {
        "operational_initially": True,  # Whether SAF sites are operational at the start
        "capex_decrease": False,  # Whether capex decreases over time to reflect technological improvement
    }
    save_booleans(booleans, "input/booleans.csv")
 
surge_values_dict = {
    "1960": 360000,
    "1961": 390000,
    "1962": 410000,
    "1963": 430000,
    "1964": 460000,
    "1965": 480000,
    "1966": 510000,
    "1967": 540000,
    "1968": 570000,
    "1969": 600000,
    "1970": 630000,
    "1971": 660000,
    "1972": 710000,
    "1973": 680000,
    "1974": 720000,
    "1975": 780000,
    "1976": 830000,
    "1977": 900000,
    "1978": 1000000,
    "1979": 990000,
    "1980": 970000,
    "1981": 970000,
    "1982": 990000,
    "1983": 1030000,
    "1984": 1130000,
    "1985": 1240000,
    "1986": 1370000,
    "1987": 1410000,
    "1988": 1460000,
    "1989": 1510000,
    "1990": 1440000,
    "1991": 1330000,
    "1992": 1330000,
    "1993": 1470000,
    "1994": 1590000,
    "1995": 1740000,
    "1996": 1810000,
    "1997": 1760000,
    "1998": 1780000,
    "1999": 1860000,
    "2000": 1910000,
    "2001": 1930000,
    "2002": 1900000,
    "2003": 2080000,
    "2004": 2360000,
    "2005": 2790000,
    "2006": 3360000,
    "2007": 3830000,
    "2008": 3740000,
    "2009": 3960000,
    "2010": 4270000,
    "2011": 4700000,
    "2012": 4510000,
    "2013": 4750000,
    "2014": 4940000,
    "2015": 5450000,
    "2016": 6110000,
    "2017": 6640000,
    "2018": 7230000,
    "2019": 7060000,
    "2020": 2960000,
    "2021": 4220000,
    "2022": 5790000,
    "2023": 6500000,
    "2024": 7010000,
    "2025": 7600000,
    "2026": 8320000,
    "2027": 9110000,
    "2028": 9980000,
    "2029": 10880000,
    "2030": 11800000,
    "2031": 12750000,
    "2032": 13710000,
    "2033": 14740000,
    "2034": 15870000,
    "2035": 17290000,
    "2036": 18880000,
    "2037": 20620000,
    "2038": 22510000,
    "2039": 24560000,
    "2040": 26750000,
    "2041": 29030000,
    "2042": 31480000,
    "2043": 34120000,
    "2044": 36940000,
    "2045": 39950000,
    "2046": 43120000,
    "2047": 46500000,
    "2048": 50070000,
    "2049": 53830000,
    "2050": 57790000,
    "2051": 61620000,
    "2052": 65600000,
    "2053": 69740000,
    "2054": 74000000,
    "2055": 78400000,
    "2056": 82760000,
    "2057": 87080000,
    "2058": 91390000,
    "2059": 95720000,
    "2060": 99990000,
    "2061": 104170000,
    "2062": 108310000,
    "2063": 112400000,
    "2064": 116440000,
    "2065": 120420000,
    "2066": 124240000,
    "2067": 128020000,
    "2068": 131770000,
    "2069": 135520000,
    "2070": 138870000,
    "2071": 142150000,
    "2072": 145430000,
    "2073": 148680000,
    "2074": 151900000,
    "2075": 155090000,
    "2076": 158180000,
    "2077": 161250000,
    "2078": 164340000,
    "2079": 167470000,
    "2080": 170620000,
    "2081": 173650000,
    "2082": 176700000,
    "2083": 179780000,
    "2084": 182870000,
    "2085": 186020000,
    "2086": 189160000,
    "2087": 192300000,
    "2088": 195440000,
    "2089": 198560000,
    "2090": 201680000,
    "2091": 204710000,
    "2092": 207720000,
    "2093": 210770000,
    "2094": 213730000,
    "2095": 215750000,
    "2096": 217730000,
    "2097": 219640000,
    "2098": 221480000,
    "2099": 223270000,
    "2100": 224990000,
}
 
save_demand(surge_values_dict, "input/surge_demand_values.csv")
 
archipelagos_values_dict = {
    "1960": 360000,
    "1961": 390000,
    "1962": 410000,
    "1963": 430000,
    "1964": 460000,
    "1965": 480000,
    "1966": 510000,
    "1967": 540000,
    "1968": 570000,
    "1969": 600000,
    "1970": 630000,
    "1971": 660000,
    "1972": 710000,
    "1973": 680000,
    "1974": 720000,
    "1975": 780000,
    "1976": 830000,
    "1977": 900000,
    "1978": 1000000,
    "1979": 990000,
    "1980": 970000,
    "1981": 970000,
    "1982": 990000,
    "1983": 1030000,
    "1984": 1130000,
    "1985": 1240000,
    "1986": 1370000,
    "1987": 1410000,
    "1988": 1460000,
    "1989": 1510000,
    "1990": 1440000,
    "1991": 1330000,
    "1992": 1330000,
    "1993": 1470000,
    "1994": 1590000,
    "1995": 1740000,
    "1996": 1810000,
    "1997": 1760000,
    "1998": 1780000,
    "1999": 1860000,
    "2000": 1910000,
    "2001": 1930000,
    "2002": 1900000,
    "2003": 2080000,
    "2004": 2360000,
    "2005": 2790000,
    "2006": 3360000,
    "2007": 3830000,
    "2008": 3740000,
    "2009": 3960000,
    "2010": 4270000,
    "2011": 4700000,
    "2012": 4510000,
    "2013": 4750000,
    "2014": 4940000,
    "2015": 5450000,
    "2016": 6110000,
    "2017": 6640000,
    "2018": 7230000,
    "2019": 7060000,
    "2020": 2960000,
    "2021": 4220000,
    "2022": 5790000,
    "2023": 6500000,
    "2024": 7010000,
    "2025": 7550000,
    "2026": 8180000,
    "2027": 8870000,
    "2028": 9650000,
    "2029": 10470000,
    "2030": 11300000,
    "2031": 12160000,
    "2032": 12990000,
    "2033": 13850000,
    "2034": 14760000,
    "2035": 15710000,
    "2036": 16720000,
    "2037": 17780000,
    "2038": 18900000,
    "2039": 20090000,
    "2040": 21350000,
    "2041": 22730000,
    "2042": 24200000,
    "2043": 25770000,
    "2044": 27420000,
    "2045": 29170000,
    "2046": 31020000,
    "2047": 32960000,
    "2048": 35000000,
    "2049": 37140000,
    "2050": 39390000,
    "2051": 41640000,
    "2052": 43980000,
    "2053": 46430000,
    "2054": 48970000,
    "2055": 51620000,
    "2056": 54360000,
    "2057": 57190000,
    "2058": 60090000,
    "2059": 63060000,
    "2060": 66030000,
    "2061": 68910000,
    "2062": 71840000,
    "2063": 74800000,
    "2064": 77790000,
    "2065": 80740000,
    "2066": 83660000,
    "2067": 86610000,
    "2068": 89560000,
    "2069": 92520000,
    "2070": 95490000,
    "2071": 98510000,
    "2072": 101530000,
    "2073": 104540000,
    "2074": 107520000,
    "2075": 110460000,
    "2076": 113350000,
    "2077": 116210000,
    "2078": 119150000,
    "2079": 122170000,
    "2080": 125280000,
    "2081": 128400000,
    "2082": 131430000,
    "2083": 134410000,
    "2084": 137350000,
    "2085": 140250000,
    "2086": 143210000,
    "2087": 146230000,
    "2088": 149200000,
    "2089": 152030000,
    "2090": 154690000,
    "2091": 157290000,
    "2092": 159810000,
    "2093": 162260000,
    "2094": 164650000,
    "2095": 166980000,
    "2096": 169160000,
    "2097": 171190000,
    "2098": 173070000,
    "2099": 174890000,
    "2100": 176670000,
}
save_demand(archipelagos_values_dict, "input/archipelagos_demand_values.csv")
 
horizon_values_dict = {
  "1960": 360000,
  "1961": 390000,
  "1962": 410000,
  "1963": 430000,
  "1964": 460000,
  "1965": 480000,
  "1966": 510000,
  "1967": 540000,
  "1968": 570000,
  "1969": 600000,
  "1970": 630000,
  "1971": 660000,
  "1972": 710000,
  "1973": 680000,
  "1974": 720000,
  "1975": 780000,
  "1976": 830000,
  "1977": 900000,
  "1978": 1000000,
  "1979": 990000,
  "1980": 970000,
  "1981": 970000,
  "1982": 990000,
  "1983": 1030000,
  "1984": 1130000,
  "1985": 1240000,
  "1986": 1370000,
  "1987": 1410000,
  "1988": 1460000,
  "1989": 1510000,
  "1990": 1440000,
  "1991": 1330000,
  "1992": 1330000,
  "1993": 1470000,
  "1994": 1590000,
  "1995": 1740000,
  "1996": 1810000,
  "1997": 1760000,
  "1998": 1780000,
  "1999": 1860000,
  "2000": 1910000,
  "2001": 1930000,
  "2002": 1900000,
  "2003": 2080000,
  "2004": 2360000,
  "2005": 2790000,
  "2006": 3360000,
  "2007": 3830000,
  "2008": 3740000,
  "2009": 3960000,
  "2010": 4270000,
  "2011": 4700000,
  "2012": 4510000,
  "2013": 4750000,
  "2014": 4940000,
  "2015": 5450000,
  "2016": 6110000,
  "2017": 6640000,
  "2018": 7230000,
  "2019": 7060000,
  "2020": 2960000,
  "2021": 4220000,
  "2022": 5790000,
  "2023": 6500000,
  "2024": 7010000,
  "2025": 7550000,
  "2026": 8180000,
  "2027": 8870000,
  "2028": 9620000,
  "2029": 10400000,
  "2030": 11170000,
  "2031": 11910000,
  "2032": 12610000,
  "2033": 13310000,
  "2034": 14040000,
  "2035": 14790000,
  "2036": 15560000,
  "2037": 16460000,
  "2038": 17390000,
  "2039": 18360000,
  "2040": 19390000,
  "2041": 20540000,
  "2042": 21770000,
  "2043": 23060000,
  "2044": 24420000,
  "2045": 25800000,
  "2046": 27250000,
  "2047": 28750000,
  "2048": 30310000,
  "2049": 31930000,
  "2050": 33600000,
  "2051": 35100000,
  "2052": 36660000,
  "2053": 38270000,
  "2054": 39940000,
  "2055": 41670000,
  "2056": 43450000,
  "2057": 45270000,
  "2058": 47140000,
  "2059": 49040000,
  "2060": 50970000,
  "2061": 52900000,
  "2062": 54850000,
  "2063": 56820000,
  "2064": 58800000,
  "2065": 60730000,
  "2066": 62620000,
  "2067": 64530000,
  "2068": 66440000,
  "2069": 68340000,
  "2070": 70230000,
  "2071": 72160000,
  "2072": 74070000,
  "2073": 75940000,
  "2074": 77760000,
  "2075": 79520000,
  "2076": 81230000,
  "2077": 82880000,
  "2078": 84550000,
  "2079": 86230000,
  "2080": 87920000,
  "2081": 89560000,
  "2082": 91140000,
  "2083": 92660000,
  "2084": 94120000,
  "2085": 95530000,
  "2086": 96930000,
  "2087": 98310000,
  "2088": 99640000,
  "2089": 100860000,
  "2090": 101980000,
  "2091": 103040000,
  "2092": 104030000,
  "2093": 104970000,
  "2094": 105860000,
  "2095": 106690000,
  "2096": 107440000,
  "2097": 108100000,
  "2098": 108680000,
  "2099": 109220000,
  "2100": 109690000
}
 
save_demand(horizon_values_dict, "input/horizon_demand_values.csv")